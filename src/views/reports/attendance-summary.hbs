<h3>Daily Attendance Analysis</h3>
<hr />

<div class="row d-print-none">
  <div class="col-md-12">
    <form method="get" action="">
      <div class="form-row align-items-center">
        <div class="col-auto">
          <label class="mb-2 sr-only-x" for="station-box">Station:</label>
          <select
            class="custom-select mb-2"
            name="station"
            id="station-box"
            required
          >
            <option value="">Choose Station...</option>
            {{#if stations}}
              {{#each stations}}
                <option value={{id}} {{selected ../queryRef.station id}}>
                  {{name}}
                </option>
              {{/each}}
            {{/if}}
          </select>
        </div>

        <div class="col-auto">
          <label class="mb-2 sr-only-x" for="month-box">Month:</label>
          <input
            type="month"
            name="monthYear"
            id="month-box"
            class="form-control mb-2"
            min="1930-01"
            max="{{queryRef.max}}"
            value="{{queryRef.current}}"
            required
          />
        </div>

        <div class="col-auto">
          <label>&nbsp;</label>
          <button type="submit" class="btn btn-danger btn-sm mb-2">Show</button>
          <button
            type="button"
            class="btn btn-secondary btn-sm mb-2"
            onclick="window.print()"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-printer"
              viewBox="0 0 16 16"
            >
              <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"></path>
              <path
                d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"
              ></path>
            </svg>
            Print
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
<hr class="mb-0 d-print-none" />

<div class="row">
  <div class="col-12">
    <div class="table-responsive-md">
      <table class="table table-striped table-bordered table-sm">
        <thead
          style="background-color:#aaaaaa;font-size:11px;line-height:normal;text-align:center"
        >
          <tr style="text-transform:uppercase;">
            <th style="text-align:right" width="2%">S/N</th>
            <th width="12%" style="text-align:left;">Date</th>
            <th>Males</th>
            <th>Females</th>
            <th>Children</th>
            <th>First-Timers</th>
            <th>New Converts</th>
            <th>Adults</th>
            <th width="7%">Total</th>
          </tr>
        </thead>

        <tbody style="font-size:smaller;line-height:normal;text-align:center;">
          {{#if records}}
            {{#each records as |recordsPerDay index|}}
              {{#each recordsPerDay as |record index0|}}
                <tr>
                  <td scope="row" style="text-align: right;">
                    {{computeSno index index0}}
                  </td>
                  <td scope="row" style="text-align: left;">
                    {{formatToDateOnly record.held_on true}}
                    <small class="text-muted d-block">{{record.tag}}</small>
                  </td>
                  <td scope="row">{{record.male}}</td>
                  <td scope="row">{{record.female}}</td>
                  <td scope="row">{{record.children}}</td>
                  <td scope="row">{{record.first_timers}}</td>
                  <td scope="row">{{record.converts}}</td>
                  <td scope="row">{{record.total_adults}}</td>
                  <td
                    scope="row"
                    style="background-color:ivory;font-weight:bold;"
                  >
                    {{record.total_attendance}}
                  </td>
                </tr>
              {{/each}}
            {{/each}}

            {{! Column-based Totals }}
            <tr style="background-color:#ffffff;line-height:normal;">
              <td colspan="9">&nbsp;</td>
            </tr>
            <tr
              bgcolor="#eaeaea"
              style="background-color:#eaeaea;line-height:normal; font-weight:bold;"
            >
              <td colspan="9">Summary Statistics</td>
            </tr>

            <tr style="background-color:ivory">
              <td colspan="9" style="line-height:normal;padding:0;">
                <table style="width: 100%; font-size:smaller">
                  <tr>
                    <td width="20%"><strong>Average Sunday Attendance:</strong></td>
                    <td></td>
                    <td width="20%"><strong>Average Mid-Week Attendance:</strong></td>
                    <td></td>
                    <td width="15%"><strong>Total First Timers:</strong></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><strong>Highest Sunday Attendance:</strong></td>
                    <td></td>
                    <td><strong>Highest Mid-Week Attendance:</strong></td>
                    <td></td>
                    <td><strong>Total New Converts:</strong></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><strong>Believers' Foundation School:</strong></td>
                    <td></td>
                    <td><strong>Water Baptism:</strong></td>
                    <td></td>
                    <td><strong>Holy Ghost Baptism:</strong></td>
                    <td></td>
                  </tr>
                </table>
              </td>
            </tr>

          {{else}}
            {{#if queryRef.station}}
              <tr>
                <td scope="row" colspan="15" style="text-align:left;">
                  No data found
                </td>
              </tr>
            {{/if}}
          {{/if}}
        </tbody>
      </table>
    </div>
  </div>
</div>
