<h3>Daily Expenditure Analysis</h3>
<hr />

<div class="row d-print-none">
  <div class="col-md-12">
    <form method="get" action="">
      <div class="form-row align-items-center">
        <div class="col-auto">
          <label class="mb-2" for="station-box">Station:</label>
          <select
            class="custom-select custom-select-sm mb-2"
            name="station"
            id="station-box"
            required
          >
            <option value="">Choose Station...</option>
            {{#if stations}}
              {{#each stations}}
                <option value={{id}} {{selected ../queryRef.station id}}>
                  {{name}}
                </option>
              {{/each}}
            {{/if}}
          </select>
        </div>

        <div class="col-auto">
          <label class="mb-2" for="month-box">Month:</label>
          <input
            type="month"
            name="monthYear"
            id="month-box"
            class="form-control form-control-sm mb-2"
            min="1930-01"
            max="{{queryRef.max}}"
            value="{{queryRef.current}}"
            required
          />
        </div>

        {{! <div class="col-auto">
          <label class="sr-only" for="inlineFormInputGroup">Username</label>
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">@</div>
            </div>
            <input
              type="text"
              class="form-control"
              id="inlineFormInputGroup"
              placeholder="Username"
            />
          </div>
        </div> }}

        {{! <div class="col-auto">
          <div class="form-check mb-2">
            <input
              class="form-check-input"
              type="checkbox"
              id="autoSizingCheck"
            />
            <label class="form-check-label" for="autoSizingCheck">
              Remember me
            </label>
          </div>
        </div> }}

        <div class="col-auto">
          <label>&nbsp;</label>
          <button type="submit" class="btn btn-danger btn-sm mb-2">Show</button>
          <button
            type="button"
            class="btn btn-secondary btn-sm mb-2"
            onclick="window.print()"
            title="Print"
          >
            {{{show-icon "print"}}}
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
<hr class="mb-0 d-print-none" />

<div class="row">
  <div class="col-12">
    <div class="table-responsive-md">
      <table class="table table-striped table-bordered table-sm">
        <thead style="font-size:11px;">
          <tr
            style="background-color:#aaaaaa;line-height:normal;text-transform:uppercase;"
          >
            <th rowspan="2" width="3%">S/N</th>
            <th rowspan="2" width="12%">Date</th>
            <th colspan="<?php echo $noofbudgetitems; ?>">Expenditure Schedule</th>
            <th rowspan="2" width="10%">Dt [&#8358;]</th>
          </tr>
          <tr style="background-color:#fafafa;line-height:normal;">
            {{#each budgetItems as |budgetItem index|}}
              <th>{{budgetItem.name}}</th>
            {{/each}}
          </tr>
        </thead>

        <tbody style="font-size: smaller;">
          {{! <?php foreach ($expensedateresults as $spend) { ?> }}
          {{! <?php $bgxcolor = Util::set_background_color($cnt++, 2); ?> }}

          <tr style="line-height:15px;">
            <td align="center">{{!<?php echo $cnt; ?>}}.</td>
            <td align="center">
              ---
              {{! <?php echo Util::_format_date($spend['date_expended'], null, '<b>D</b>, j-M-Y'); ?> }}
            </td>

            {{! <?php
              foreach ($budgetitems as $item) {
                  #define method parameters
                  $itemId = $item['btid'];
                  $expensedate = $spend['date_expended'];

                  $itemspend = Church::get_item_total_daily_expenditure($churchId, $itemId, $expensedate);
                  $expendedamount[$item['btid']] += $itemspend;
                  $totaldailyspend += $itemspend;
              ?> }}

            <td align="right">
              ---
              {{! <?php echo number_format($itemspend, 2); ?> }}
            </td>

            {{! <?php } ?> }}

            <td align="right" style="background-color:ivory;font-weight:bold;">
              ---
              {{! <?php echo number_format($totaldailyspend, 2); ?> }}
            </td>
          </tr>

          {{! <?php
              $totaldailyspend = 0; #reset value for next iteration
              ?> }}
          {{! <?php } ?> }}
        </tbody>

        <tfoot style="font-size: smaller;">
          <tr style="background-color:ivory;font-weight:bold;line-height:20px;">
            <td colspan="2" align="right">Total: [&#8358;]</td>

            {{#each budgetItems as |item index|}}
              <td align="right">
                ---
                {{! <?php
                $totalitemexpense   = $expendedamount[$item['btid']];
                $totalmonthlyspend += $totalitemexpense;

                echo number_format($totalitemexpense, 2, '.', ',');
                ?> }}
              </td>
            {{/each}}

            <td align="right">
              {{! <?php echo number_format($totalmonthlyspend, 2); ?> }}
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>
